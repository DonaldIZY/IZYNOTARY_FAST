import{_ as P}from"./ClAYQHhI.js";import{_ as q}from"./jk-e8p3X.js";import{V as z,_ as L}from"./DAOtDWvy.js";import{_ as G}from"./D1tss4Vx.js";import{r as a,D as O,F as j,v as H,x as c,z as l,A as o,N as $,L as i,J as h,t as J,a4 as M,M as d,B as x,a1 as v,q as K}from"./DXnXjm7K.js";import{p as Q}from"./eMPb1Mbx.js";import{V as U,a as r}from"./B8Rr4oru.js";import{V as B}from"./BWQEG_-l.js";import{a as W}from"./BS0uIqYZ.js";import"./B22xuEom.js";import"./CSLxKgvM.js";import"./aLweXgft.js";import"./CHercgjs.js";import"./Ctz4MgHs.js";const X={class:"ma-4"},Y={class:"ma-2"},Z={class:"d-flex flex-column justify-center"},ee={class:"ma-4 d-flex justify-end"},Ne={__name:"modificationCompany",setup(le){const f=a(!1),A=a(!1),T=a([]),N=a(null),m=a(null),V=a(""),_=a(""),b=a(""),y=a(""),C=a(""),D=a(null),E=a(null),I=a(null),g=a(null),F=()=>{f.value=!f.value},R=K(),S=async()=>{try{const e=await $fetch("http://serverizynotary.izydr.net/customers");e&&(T.value=e.map(s=>({ID:s.id,LASTNAME:s.lastName,FIRSTNAME:s.firstName,NAME:s.lastName+" "+s.firstName,IDENTIFICATION_NUMBER:s.identificationNumber,BIRTHDATE:s.birthDate,GENDER:s.gender})))}catch(n){console.error("Erreur lors du chargement des clients :",n)}};S(),O(()=>{f.value||S()}),j(N,n=>{m.value=T.value.find(e=>e.ID===n.ID),m.value&&(_.value=m.value.LASTNAME,V.value=m.value.FIRSTNAME,b.value=new Date(m.value.BIRTHDATE).toLocaleDateString(),y.value=m.value.GENDER,C.value=m.value.IDENTIFICATION_NUMBER)});const w=async()=>{const n=new FormData,s=(await $fetch(`${R.public.baseUrl}/folders`)).length;if(isNaN(s)){console.error("Erreur : count est NaN");return}n.append("folderNum",Q("Modification de société",s)),n.append("procedureType","Modification de société"),n.append("progression",1/6),n.append("status","En cours"),n.append("customerId",m.value.ID);const p={customerCNI:D.value,RCCM:E.value,status:I.value,DNSV:g.value};for(const u in p)p[u]&&n.append(`${u}`,p[u]);try{const u=await $fetch(`${R.public.baseUrl}/folders/companyModification`,{method:"POST",body:n});alert("Procédure créée avec succès.")}catch(u){console.error("Erreur lors de la création de la procédure :",u)}};return(n,e)=>{const s=P,p=q,u=L,k=G;return J(),H(h,null,[c("div",X,[l(s,{title:"Procédure de modification de société",goBackTo:"/addProcedure"})]),c("div",Y,[l(U,null,{default:o(()=>[l(r,{cols:"12",lg:"5"},{default:o(()=>[l(U,null,{default:o(()=>[l(r,{cols:"12"},{default:o(()=>[l(M,{elevation:4,rounded:"",height:"100%",class:"pa-2"},{default:o(()=>[e[14]||(e[14]=c("h4",{class:"mb-3"},"Sélection du client",-1)),c("div",Z,[l(B,null,{default:o(()=>[l(z,{modelValue:i(N),"onUpdate:modelValue":e[0]||(e[0]=t=>d(N)?N.value=t:null),color:"primary",label:"Selectionner un client",items:i(T),"item-title":"NAME","item-value":"ID",variant:"outlined","hide-details":"",density:"compact"},null,8,["modelValue","items"])]),_:1}),l(W,{class:"my-5"},{default:o(()=>e[12]||(e[12]=[x("ou")])),_:1}),l($,{color:"primary",class:"text-none align-self-center","prepend-icon":"mdi-account-tie",onClick:F},{default:o(()=>e[13]||(e[13]=[x("Créer un client")])),_:1}),l(p,{open:i(f),"onUpdate:open":e[1]||(e[1]=t=>f.value=t)},null,8,["open"])])]),_:1})]),_:1}),l(r,{cols:"12"},{default:o(()=>[l(M,{elevation:4,rounded:"",height:"100%",class:"pa-2"},{default:o(()=>[e[15]||(e[15]=c("h4",{class:"mb-3"},"Aperçu informations du client",-1)),l(B,null,{default:o(()=>[l(U,null,{default:o(()=>[l(r,{cols:"12",sm:"5"},{default:o(()=>[l(v,{modelValue:i(_),"onUpdate:modelValue":e[2]||(e[2]=t=>d(_)?_.value=t:null),color:"primary",label:"Nom",variant:"outlined","hide-details":"",disabled:"",density:"compact"},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",sm:"7"},{default:o(()=>[l(v,{modelValue:i(V),"onUpdate:modelValue":e[3]||(e[3]=t=>d(V)?V.value=t:null),color:"primary",label:"Prénoms",variant:"outlined","hide-details":"",disabled:"",density:"compact"},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",sm:"5"},{default:o(()=>[l(v,{modelValue:i(C),"onUpdate:modelValue":e[4]||(e[4]=t=>d(C)?C.value=t:null),color:"primary",label:"CNI",variant:"outlined","hide-details":"",disabled:"",density:"compact"},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",sm:"4"},{default:o(()=>[l(v,{modelValue:i(b),"onUpdate:modelValue":e[5]||(e[5]=t=>d(b)?b.value=t:null),color:"primary",label:"Date de naissance",variant:"outlined","hide-details":"",disabled:"",density:"compact"},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",sm:"3"},{default:o(()=>[l(v,{modelValue:i(y),"onUpdate:modelValue":e[6]||(e[6]=t=>d(y)?y.value=t:null),color:"primary",label:"Sexe",variant:"outlined","hide-details":"",disabled:"",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(r,{cols:"12",lg:"7"},{default:o(()=>[l(M,{elevation:4,rounded:"",height:"100%",class:"pa-4"},{default:o(()=>[e[16]||(e[16]=c("h4",{class:"mb-3"},"Documents requis pour initier la procédure",-1)),l(U,null,{default:o(()=>[l(r,{cols:"12"},{default:o(()=>[l(u,{label:"CNI du client",file:i(D),"onUpdate:file":e[7]||(e[7]=t=>d(D)?D.value=t:null)},null,8,["file"])]),_:1}),l(r,{cols:"12"},{default:o(()=>[l(u,{label:"RCCM",file:i(E),"onUpdate:file":e[8]||(e[8]=t=>d(E)?E.value=t:null)},null,8,["file"])]),_:1}),l(r,{cols:"12"},{default:o(()=>[l(u,{label:"Statut",file:i(I),"onUpdate:file":e[9]||(e[9]=t=>d(I)?I.value=t:null)},null,8,["file"])]),_:1}),l(r,{cols:"12"},{default:o(()=>[l(u,{label:"DNSV",file:i(g),"onUpdate:file":e[10]||(e[10]=t=>d(g)?g.value=t:null)},null,8,["file"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),c("div",ee,[l($,{color:"primary",class:"text-none","prepend-icon":"mdi-content-save-outline",onClick:w},{default:o(()=>e[17]||(e[17]=[x(" Enregistrer la procédure ")])),_:1}),l(k,{text:"Voulez vous enregistrer la procédure de modification de société ?",open:i(A),"onUpdate:open":e[11]||(e[11]=t=>A.value=t)},null,8,["open"])])],64)}}};export{Ne as default};
