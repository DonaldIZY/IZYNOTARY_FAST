import{V as Ie}from"./aLweXgft.js";import{r as S,t as T,v as P,z as o,L as g,M as ae,A as B,B as X,N as Te,y as te,J as K,x as ne,a6 as Pe,aD as Ee,br as Le,bs as Me,ai as Ue,at as Be,Q as j,aj as ue,i as k,as as je,bt as Ne,F as N,aA as oe,bu as Oe,aF as Ke,a1 as ie,bv as ze,aw as L,a3 as se,bw as He,av as qe,bx as We,aG as $e,bg as Ge,by as re,bz as Je}from"./DXnXjm7K.js";import{V as Qe,a as Xe,b as Ye}from"./B22xuEom.js";import{V as Ze}from"./CHercgjs.js";import{e as el,f as ll,g as al,t as O,u as tl,h as nl,i as ul,j as ce,k as ol,d as il,c as sl}from"./BS0uIqYZ.js";import{a as rl}from"./CSLxKgvM.js";const cl={class:"d-flex align-center ga-8"},vl=["src"],dl=["src"],fl={key:2,style:{"white-space":"pre-wrap","max-height":"400px",overflow:"auto"}},ml=["innerHTML"],bl=["href"],hl={key:5},_l={__name:"requiredDocument",props:{label:{type:String,required:!0}},emits:["update:file"],setup(e,{emit:V}){const D=V,n=S(!1),y=S(null),s=S(null),v=S(null),w=()=>{n.value=!n.value},M=async()=>{if(s.value&&v.value==="pdf"&&URL.revokeObjectURL(s.value),s.value=null,v.value=null,y.value){const C=y.value,f=C.name.split(".").pop().toLowerCase();try{if(["jpg","jpeg","png"].includes(f)){v.value="image";const m=new FileReader;m.onload=r=>{s.value=r.target.result},m.readAsDataURL(C)}else if(f==="pdf")v.value="pdf",s.value=URL.createObjectURL(y);else if(f==="txt"){v.value="text";const m=new FileReader;m.onload=r=>{s.value=r.target.result},m.readAsText(C)}else if(f==="docx"){v.value="docx";const m=new FileReader;m.onload=async r=>{const c=r.target.result,U=await mammoth.convertToHtml({arrayBuffer:c});s.value=U.value},m.readAsArrayBuffer(C)}else f==="doc"?(v.value="doc",s.value=URL.createObjectURL(C)):(v.value=null,s.value="Type de fichier non supporté.");D("update:file",C)}catch(m){console.error("Erreur lors de la prévisualisation du fichier :",m),s.value="Erreur lors du traitement du fichier."}D("update:file",y.value)}};return(C,f)=>(T(),P("div",cl,[o(Ie,{label:e.label,variant:"outlined","hide-details":"",modelValue:g(y),"onUpdate:modelValue":f[0]||(f[0]=m=>ae(y)?y.value=m:null),accept:".jpg,.jpeg,.png,.pdf,.doc,.docx,.txt",onChange:M,density:"compact"},null,8,["label","modelValue"]),o(Te,{color:"primary",onClick:w,class:"text-none",disabled:!g(y)},{default:B(()=>f[2]||(f[2]=[X(" Aperçu ")])),_:1},8,["disabled"]),o(Ze,{modelValue:g(n),"onUpdate:modelValue":f[1]||(f[1]=m=>ae(n)?n.value=m:null),width:"50%",class:"ma-4"},{default:B(()=>[o(Qe,null,{default:B(()=>[o(Xe,null,{default:B(()=>[X(te(e.label),1)]),_:1}),o(Ye,null,{default:B(()=>[g(v)==="image"?(T(),P("img",{key:0,src:g(s),alt:"Prévisualisation",style:{"max-width":"100%"}},null,8,vl)):g(v)==="pdf"?(T(),P("iframe",{key:1,src:g(s),style:{width:"100%",height:"400px"},frameborder:"0"},null,8,dl)):g(v)==="text"?(T(),P("pre",fl,te(g(s)),1)):g(v)==="docx"?(T(),P("div",{key:3,innerHTML:g(s)},null,8,ml)):g(v)==="doc"?(T(),P(K,{key:4},[f[3]||(f[3]=ne("p",null," Impossible de prévisualiser le fichier Word (.doc). Vous pouvez le télécharger ci-dessous : ",-1)),ne("a",{href:g(s),download:"",class:"v-btn v-btn--outlined primary text-none"}," Télécharger le fichier ",8,bl)],64)):(T(),P("p",hl,"Aucun aperçu disponible pour ce type de fichier."))]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};function pl(e,V,D){if(V==null)return e;if(Array.isArray(V))throw new Error("Multiple matches is not implemented");return typeof V=="number"&&~V?o(K,null,[o("span",{class:"v-combobox__unmask"},[e.substr(0,V)]),o("span",{class:"v-combobox__mask"},[e.substr(V,D)]),o("span",{class:"v-combobox__unmask"},[e.substr(V+D)])]):e}const gl=Pe({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...el({filterKeys:["title"]}),...ll({hideNoData:!0,returnObject:!0}),...Ee(Le({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Me({transition:!1})},"VCombobox"),Fl=Ue()({name:"VCombobox",props:gl(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,V){var Z;let{emit:D,slots:n}=V;const{t:y}=Be(),s=S(),v=j(!1),w=j(!0),M=j(!1),C=S(),f=S(),m=ue(e,"menu"),r=k({get:()=>m.value,set:l=>{var a;m.value&&!l&&((a=C.value)!=null&&a.ΨopenChildren.size)||(m.value=l)}}),c=j(-1);let U=!1;const ve=k(()=>{var l;return(l=s.value)==null?void 0:l.color}),Y=k(()=>r.value?e.closeText:e.openText),{items:de,transformIn:fe,transformOut:me}=al(e),{textColorClasses:be,textColorStyles:he}=je(ve),u=ue(e,"modelValue",[],l=>fe(Ge(l)),l=>{const a=me(l);return e.multiple?a:a[0]??null}),z=Ne(e),H=k(()=>!!(e.chips||n.chip)),F=k(()=>H.value||!!n.selection),R=j(!e.multiple&&!F.value?((Z=u.value[0])==null?void 0:Z.title)??"":""),b=k({get:()=>R.value,set:l=>{var a;if(R.value=l??"",!e.multiple&&!F.value&&(u.value=[O(e,l)]),l&&e.multiple&&((a=e.delimiters)!=null&&a.length)){const d=l.split(new RegExp(`(?:${e.delimiters.join("|")})+`));d.length>1&&(d.forEach(t=>{t=t.trim(),t&&_(O(e,t))}),R.value="")}l||(c.value=-1),w.value=!l}}),pe=k(()=>typeof e.counterValue=="function"?e.counterValue(u.value):typeof e.counterValue=="number"?e.counterValue:e.multiple?u.value.length:b.value.length);N(R,l=>{U?oe(()=>U=!1):v.value&&!r.value&&(r.value=!0),D("update:search",l)}),N(u,l=>{var a;!e.multiple&&!F.value&&(R.value=((a=l[0])==null?void 0:a.title)??"")});const{filteredItems:q,getMatches:ge}=tl(e,de,()=>w.value?"":b.value),A=k(()=>e.hideSelected?q.value.filter(l=>!u.value.some(a=>a.value===l.value)):q.value),ye=k(()=>u.value.map(l=>l.value)),G=k(()=>{var a;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&b.value===((a=A.value[0])==null?void 0:a.title))&&A.value.length>0&&!w.value&&!M.value}),J=k(()=>e.hideNoData&&!A.value.length||z.isReadonly.value||z.isDisabled.value),Q=S(),xe=nl(Q,s);function Ve(l){U=!0,e.openOnClear&&(r.value=!0)}function ke(){J.value||(r.value=!0)}function we(l){J.value||(v.value&&(l.preventDefault(),l.stopPropagation()),r.value=!r.value)}function Ce(l){var a;l.key!==" "&&re(l)&&((a=s.value)==null||a.focus())}function _e(l){var t;if(Je(l)||z.isReadonly.value)return;const a=s.value.selectionStart,d=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(l.key)&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(r.value=!0),["Escape"].includes(l.key)&&(r.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(G.value&&["Enter","Tab"].includes(l.key)&&!u.value.some(i=>{let{value:x}=i;return x===A.value[0].value})&&_(q.value[0]),w.value=!0),l.key==="ArrowDown"&&G.value&&((t=Q.value)==null||t.focus("next")),l.key==="Enter"&&b.value&&(_(O(e,b.value)),F.value&&(R.value="")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&F.value&&u.value.length>0&&!b.value)return _(u.value[0],!1);if(~c.value){l.preventDefault();const i=c.value;_(u.value[c.value],!1),c.value=i>=d-1?d-2:i}else l.key==="Backspace"&&!b.value&&(c.value=d-1);return}if(e.multiple)if(l.key==="ArrowLeft"){if(c.value<0&&a>0)return;const i=c.value>-1?c.value-1:d-1;u.value[i]?c.value=i:(c.value=-1,s.value.setSelectionRange(b.value.length,b.value.length))}else if(l.key==="ArrowRight"){if(c.value<0)return;const i=c.value+1;u.value[i]?c.value=i:(c.value=-1,s.value.setSelectionRange(0,0))}else~c.value&&re(l)&&(c.value=-1)}function Fe(){var l;e.eager&&((l=f.value)==null||l.calculateVisibleItems())}function Re(){var l;v.value&&(w.value=!0,(l=s.value)==null||l.focus())}function _(l){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!l||l.props.disabled))if(e.multiple){const d=u.value.findIndex(i=>e.valueComparator(i.value,l.value)),t=a??!~d;if(~d){const i=t?[...u.value,l]:[...u.value];i.splice(d,1),u.value=i}else t&&(u.value=[...u.value,l]);e.clearOnSelect&&(b.value="")}else{const d=a!==!1;u.value=d?[l]:[],R.value=d&&!F.value?l.title:"",oe(()=>{r.value=!1,w.value=!0})}}function Ae(l){v.value=!0,setTimeout(()=>{M.value=!0})}function Se(l){M.value=!1}function De(l){(l==null||l===""&&!e.multiple&&!F.value)&&(u.value=[])}return N(v,(l,a)=>{if(!(l||l===a)&&(c.value=-1,r.value=!1,b.value)){if(e.multiple){_(O(e,b.value));return}if(!F.value)return;u.value.some(d=>{let{title:t}=d;return t===b.value})?R.value="":_(O(e,b.value))}}),N(r,()=>{if(!e.hideSelected&&r.value&&u.value.length){const l=A.value.findIndex(a=>u.value.some(d=>e.valueComparator(d.value,a.value)));Oe&&window.requestAnimationFrame(()=>{var a;l>=0&&((a=f.value)==null||a.scrollToIndex(l))})}}),N(()=>e.items,(l,a)=>{r.value||v.value&&!a.length&&l.length&&(r.value=!0)}),Ke(()=>{const l=!!(!e.hideNoData||A.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),a=u.value.length>0,d=ie.filterProps(e);return o(ie,L({ref:s},d,{modelValue:b.value,"onUpdate:modelValue":[t=>b.value=t,De],focused:v.value,"onUpdate:focused":t=>v.value=t,validationValue:u.externalValue,counterValue:pe.value,dirty:a,class:["v-combobox",{"v-combobox--active-menu":r.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!F.value,"v-combobox--selecting-index":c.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:z.isReadonly.value,placeholder:a?void 0:e.placeholder,"onClick:clear":Ve,"onMousedown:control":ke,onKeydown:_e}),{...n,default:()=>o(K,null,[o(ze,L({ref:C,modelValue:r.value,"onUpdate:modelValue":t=>r.value=t,activator:"parent",contentClass:"v-combobox__content",disabled:J.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:Fe,onAfterLeave:Re},e.menuProps),{default:()=>[l&&o(ul,L({ref:Q,selected:ye.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:t=>t.preventDefault(),onKeydown:Ce,onFocusin:Ae,onFocusout:Se,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},xe,e.listProps),{default:()=>{var t,i,x;return[(t=n["prepend-item"])==null?void 0:t.call(n),!A.value.length&&!e.hideNoData&&(((i=n["no-data"])==null?void 0:i.call(n))??o(ce,{key:"no-data",title:y(e.noDataText)},null)),o(ol,{ref:f,renderless:!0,items:A.value},{default:I=>{var le;let{item:h,index:E,itemRef:p}=I;const ee=L(h.props,{ref:p,key:h.value,active:G.value&&E===0?!0:void 0,onClick:()=>_(h,null)});return((le=n.item)==null?void 0:le.call(n,{item:h,index:E,props:ee}))??o(ce,L(ee,{role:"option"}),{prepend:W=>{let{isSelected:$}=W;return o(K,null,[e.multiple&&!e.hideSelected?o(il,{key:h.value,modelValue:$,ripple:!1,tabindex:"-1"},null):void 0,h.props.prependAvatar&&o(rl,{image:h.props.prependAvatar},null),h.props.prependIcon&&o(se,{icon:h.props.prependIcon},null)])},title:()=>{var W,$;return w.value?h.title:pl(h.title,(W=ge(h))==null?void 0:W.title,(($=b.value)==null?void 0:$.length)??0)}})}}),(x=n["append-item"])==null?void 0:x.call(n)]}})]}),u.value.map((t,i)=>{function x(p){p.stopPropagation(),p.preventDefault(),_(t,!1)}const I={"onClick:close":x,onKeydown(p){p.key!=="Enter"&&p.key!==" "||(p.preventDefault(),p.stopPropagation(),x(p))},onMousedown(p){p.preventDefault(),p.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},h=H.value?!!n.chip:!!n.selection,E=h?He(H.value?n.chip({item:t,index:i,props:I}):n.selection({item:t,index:i})):void 0;if(!(h&&!E))return o("div",{key:t.value,class:["v-combobox__selection",i===c.value&&["v-combobox__selection--selected",be.value]],style:i===c.value?he.value:{}},[H.value?n.chip?o(qe,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:t.title}}},{default:()=>[E]}):o(sl,L({key:"chip",closable:e.closableChips,size:"small",text:t.title,disabled:t.props.disabled},I),null):E??o("span",{class:"v-combobox__selection-text"},[t.title,e.multiple&&i<u.value.length-1&&o("span",{class:"v-combobox__selection-comma"},[X(",")])])])})]),"append-inner":function(){var I;for(var t=arguments.length,i=new Array(t),x=0;x<t;x++)i[x]=arguments[x];return o(K,null,[(I=n["append-inner"])==null?void 0:I.call(n,...i),(!e.hideNoData||e.items.length)&&e.menuIcon?o(se,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:we,onClick:We,"aria-label":y(Y.value),title:y(Y.value),tabindex:"-1"},null):void 0])}})}),$e({isFocused:v,isPristine:w,menu:r,search:b,selectionIndex:c,filteredItems:q,select:_},s)}});export{Fl as V,_l as _};
